{
  "run_name": "unet_2d_per_class_weighted_focal_20260210_233746",
  "loss_name": "per_class_weighted_focal",
  "loss_config": {
    "type": "per_class_combo",
    "bce_weight": 0.3,
    "dice_weight": 0.5,
    "focal_weight": 0.2,
    "focal_gamma": 2.0,
    "class_weights": {
      "nuc": 1.8,
      "endo_mem": 1.7,
      "endo_lum": 1.7,
      "pm": 1.6,
      "er_mem": 1.6,
      "er_lum": 1.5,
      "ves_mem": 1.4,
      "mito_mem": 1.3,
      "mito_lum": 1.2,
      "ves_lum": 1.2,
      "ecs": 1.2,
      "golgi_lum": 1.2,
      "mito_ribo": 1.0,
      "golgi_mem": 1.1
    },
    "description": "Per-class weighted Dice+BCE+Focal (best of both worlds)"
  },
  "train_config": {
    "epochs": 60,
    "iterations_per_epoch": 100,
    "batch_size": 28,
    "learning_rate": 0.0001,
    "classes": [
      "nuc",
      "mito_mem",
      "er_mem",
      "pm",
      "golgi_mem"
    ],
    "validate_every": 5
  },
  "best_dice": 0.3072918163286074,
  "elapsed_seconds": 35148.769948244095,
  "history": [
    {
      "epoch": 5,
      "train_loss": 0.8869331449270248,
      "val_loss": 0.9858345031738281,
      "dice_mean": 0.07407382872524368,
      "per_class": {
        "nuc": {
          "dice": 0.16024935366739287,
          "tp": 689573,
          "fp": 7090647,
          "fn": 136457
        },
        "mito_mem": {
          "dice": 0.11036429872495446,
          "tp": 133298,
          "fp": 1302294,
          "fn": 846710
        },
        "er_mem": {
          "dice": 0.04700587183692423,
          "tp": 28647,
          "fp": 426062,
          "fn": 735513
        },
        "pm": {
          "dice": 0.04853124786722818,
          "tp": 60443,
          "fp": 2037862,
          "fn": 332142
        },
        "golgi_mem": {
          "dice": 0.004218371529718651,
          "tp": 566,
          "fp": 230589,
          "fn": 36629
        }
      }
    },
    {
      "epoch": 10,
      "train_loss": 0.8400607508420944,
      "val_loss": 0.9430386155843735,
      "dice_mean": 0.10868503370738702,
      "per_class": {
        "nuc": {
          "dice": 0.2554136259726971,
          "tp": 848192,
          "fp": 4821944,
          "fn": 123385
        },
        "mito_mem": {
          "dice": 0.1426795915408021,
          "tp": 176619,
          "fp": 1363511,
          "fn": 758994
        },
        "er_mem": {
          "dice": 0.06894471393589745,
          "tp": 43655,
          "fp": 373366,
          "fn": 805701
        },
        "pm": {
          "dice": 0.06293144442404808,
          "tp": 57766,
          "fp": 1391586,
          "fn": 328721
        },
        "golgi_mem": {
          "dice": 0.01345579266349043,
          "tp": 1583,
          "fp": 186862,
          "fn": 45261
        }
      }
    },
    {
      "epoch": 15,
      "train_loss": 0.8223498612642288,
      "val_loss": 0.9431619137525559,
      "dice_mean": 0.08995606660410668,
      "per_class": {
        "nuc": {
          "dice": 0.25512338999235706,
          "tp": 901435,
          "fp": 5078677,
          "fn": 185112
        },
        "mito_mem": {
          "dice": 0.0882453226131932,
          "tp": 88771,
          "fp": 992718,
          "fn": 841654
        },
        "er_mem": {
          "dice": 0.031075326576050572,
          "tp": 15967,
          "fp": 123988,
          "fn": 871710
        },
        "pm": {
          "dice": 0.0678550100547973,
          "tp": 43916,
          "fp": 838595,
          "fn": 367980
        },
        "golgi_mem": {
          "dice": 0.007481283784135308,
          "tp": 719,
          "fp": 156379,
          "fn": 34396
        }
      }
    },
    {
      "epoch": 20,
      "train_loss": 0.7972094875574112,
      "val_loss": 0.9597903221845627,
      "dice_mean": 0.11486535879069815,
      "per_class": {
        "nuc": {
          "dice": 0.24969368161175287,
          "tp": 860181,
          "fp": 5040288,
          "fn": 129240
        },
        "mito_mem": {
          "dice": 0.1628768655376666,
          "tp": 303931,
          "fp": 2387354,
          "fn": 736818
        },
        "er_mem": {
          "dice": 0.10750849774689712,
          "tp": 76715,
          "fp": 447195,
          "fn": 826518
        },
        "pm": {
          "dice": 0.05139676713268898,
          "tp": 59313,
          "fp": 1898486,
          "fn": 290932
        },
        "golgi_mem": {
          "dice": 0.002850981924485159,
          "tp": 197,
          "fp": 106323,
          "fn": 31481
        }
      }
    },
    {
      "epoch": 25,
      "train_loss": 0.7833970510959625,
      "val_loss": 0.9319807112216949,
      "dice_mean": 0.12008218951974428,
      "per_class": {
        "nuc": {
          "dice": 0.25278928296307557,
          "tp": 731782,
          "fp": 4172601,
          "fn": 153495
        },
        "mito_mem": {
          "dice": 0.16409833497720866,
          "tp": 229429,
          "fp": 1636414,
          "fn": 700966
        },
        "er_mem": {
          "dice": 0.13269241294838663,
          "tp": 89701,
          "fp": 376897,
          "fn": 795715
        },
        "pm": {
          "dice": 0.05075281459153046,
          "tp": 39542,
          "fp": 1126095,
          "fn": 353040
        },
        "golgi_mem": {
          "dice": 7.810211851996486e-05,
          "tp": 2,
          "fp": 14175,
          "fn": 37036
        }
      }
    },
    {
      "epoch": 30,
      "train_loss": 0.7582147181034088,
      "val_loss": 0.9081875294446945,
      "dice_mean": 0.1618393220653951,
      "per_class": {
        "nuc": {
          "dice": 0.2768628861427224,
          "tp": 819818,
          "fp": 4116288,
          "fn": 166271
        },
        "mito_mem": {
          "dice": 0.22358597192662485,
          "tp": 451626,
          "fp": 2578587,
          "fn": 558003
        },
        "er_mem": {
          "dice": 0.2501923492543765,
          "tp": 260469,
          "fp": 909544,
          "fn": 651668
        },
        "pm": {
          "dice": 0.05842062984332658,
          "tp": 62508,
          "fp": 1654625,
          "fn": 360288
        },
        "golgi_mem": {
          "dice": 0.0001347731599252009,
          "tp": 4,
          "fp": 22418,
          "fn": 36933
        }
      }
    },
    {
      "epoch": 35,
      "train_loss": 0.7453487294912339,
      "val_loss": 0.8578813195228576,
      "dice_mean": 0.2041615647535473,
      "per_class": {
        "nuc": {
          "dice": 0.32830908308670403,
          "tp": 851237,
          "fp": 3239409,
          "fn": 243700
        },
        "mito_mem": {
          "dice": 0.3351289233097364,
          "tp": 441808,
          "fp": 1187743,
          "fn": 565286
        },
        "er_mem": {
          "dice": 0.2935312409785417,
          "tp": 262838,
          "fp": 623336,
          "fn": 641857
        },
        "pm": {
          "dice": 0.06383857639275427,
          "tp": 34694,
          "fp": 667527,
          "fn": 350014
        },
        "golgi_mem": {
          "dice": 0.0,
          "tp": 0,
          "fp": 4580,
          "fn": 38463
        }
      }
    },
    {
      "epoch": 40,
      "train_loss": 0.7124260711669922,
      "val_loss": 0.9084784060716629,
      "dice_mean": 0.18755543242112344,
      "per_class": {
        "nuc": {
          "dice": 0.2604886931009042,
          "tp": 728739,
          "fp": 4055024,
          "fn": 82666
        },
        "mito_mem": {
          "dice": 0.24492238076724163,
          "tp": 303324,
          "fp": 1399538,
          "fn": 470713
        },
        "er_mem": {
          "dice": 0.2922279316738528,
          "tp": 330814,
          "fp": 1072125,
          "fn": 530329
        },
        "pm": {
          "dice": 0.13923668716850443,
          "tp": 91605,
          "fp": 819416,
          "fn": 313191
        },
        "golgi_mem": {
          "dice": 0.0009014693951140359,
          "tp": 20,
          "fp": 8514,
          "fn": 35818
        }
      }
    },
    {
      "epoch": 45,
      "train_loss": 0.6887547695636749,
      "val_loss": 0.8304510533809661,
      "dice_mean": 0.23104621157949717,
      "per_class": {
        "nuc": {
          "dice": 0.36812605024937173,
          "tp": 842217,
          "fp": 2651796,
          "fn": 239469
        },
        "mito_mem": {
          "dice": 0.3382642643015411,
          "tp": 545008,
          "fp": 1622988,
          "fn": 509376
        },
        "er_mem": {
          "dice": 0.29269314879281805,
          "tp": 229070,
          "fp": 466573,
          "fn": 640544
        },
        "pm": {
          "dice": 0.15563223394448428,
          "tp": 97244,
          "fp": 798979,
          "fn": 256197
        },
        "golgi_mem": {
          "dice": 0.0005153606092707648,
          "tp": 9,
          "fp": 1979,
          "fn": 32930
        }
      }
    },
    {
      "epoch": 50,
      "train_loss": 0.6610456532239914,
      "val_loss": 0.8281687915325164,
      "dice_mean": 0.2451118244576965,
      "per_class": {
        "nuc": {
          "dice": 0.37239429536095914,
          "tp": 1006997,
          "fp": 3257070,
          "fn": 137166
        },
        "mito_mem": {
          "dice": 0.3414804878833227,
          "tp": 360992,
          "fp": 886503,
          "fn": 505789
        },
        "er_mem": {
          "dice": 0.3394694475347907,
          "tp": 331681,
          "fp": 777330,
          "fn": 513422
        },
        "pm": {
          "dice": 0.1686650345633467,
          "tp": 107028,
          "fp": 786166,
          "fn": 268897
        },
        "golgi_mem": {
          "dice": 0.0035498569460633675,
          "tp": 67,
          "fp": 11623,
          "fn": 25991
        }
      }
    },
    {
      "epoch": 55,
      "train_loss": 0.6299927848577499,
      "val_loss": 0.8191781461238861,
      "dice_mean": 0.2379030984919695,
      "per_class": {
        "nuc": {
          "dice": 0.3316876320992705,
          "tp": 778378,
          "fp": 2899318,
          "fn": 237366
        },
        "mito_mem": {
          "dice": 0.3556278026304137,
          "tp": 530086,
          "fp": 1466899,
          "fn": 454057
        },
        "er_mem": {
          "dice": 0.337667730631773,
          "tp": 416333,
          "fp": 1129686,
          "fn": 503581
        },
        "pm": {
          "dice": 0.15434632178395277,
          "tp": 108291,
          "fp": 925963,
          "fn": 260676
        },
        "golgi_mem": {
          "dice": 0.010186005314437556,
          "tp": 575,
          "fp": 74009,
          "fn": 37741
        }
      }
    },
    {
      "epoch": 60,
      "train_loss": 0.6082476025819779,
      "val_loss": 0.7433783292770386,
      "dice_mean": 0.3072918163286074,
      "per_class": {
        "nuc": {
          "dice": 0.4779087748911579,
          "tp": 984153,
          "fp": 1980197,
          "fn": 170078
        },
        "mito_mem": {
          "dice": 0.4508732810950549,
          "tp": 550606,
          "fp": 959628,
          "fn": 381558
        },
        "er_mem": {
          "dice": 0.32049072947435425,
          "tp": 264580,
          "fp": 536576,
          "fn": 585357
        },
        "pm": {
          "dice": 0.21385513816842222,
          "tp": 165853,
          "fp": 979358,
          "fn": 240014
        },
        "golgi_mem": {
          "dice": 0.07333115801404798,
          "tp": 4270,
          "fp": 84097,
          "fn": 23821
        }
      }
    }
  ]
}